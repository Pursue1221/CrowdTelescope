// lng: 113.5454988051415, lat: 22.128148778761755
data1=[{"a":"\u6587\u5316\u4ea4\u6d41\u4e2d\u5fc3 - \u5927\u5b78\u6703\u5802","b":"N2","lat":22.1342,"lon":113.54551},
// {"a":"\u4e2d\u592e\u6559\u5b78\u6a13","b":"CTB","lat":22.12848,"lon":113.54541},
{"a":"\u4e2d\u592e\u6559\u5b66\u697c","b":"E3CT","lat":22.12904,"lon":113.54585},
{"a":"\u4e2d\u592e\u6559\u5b66\u697c","b":"E4CT","lat":22.12861,"lon":113.54607},
{"a":"\u4e2d\u592e\u6559\u5b66\u697c","b":"E5CT","lat": 22.128136049065404,"lon": 113.54543930551836},
{"a":"\u4e2d\u592e\u6559\u5b66\u697c","b":"E6CT","lat":22.1286,"lon":113.54509},
{"a":"\u4e2d\u592e\u6559\u5b66\u697c","b":"E7CT","lat":22.12895,"lon":113.54514},
{"a":"\u4e2d\u592e\u884c\u653f\u6a13","b":"CAB","lat":22.13382,"lon":113.54424},
{"a":"\u5716\u66f8\u9928","b":"LIB(E2)","lat":22.13003,"lon":113.54486},
{"a":"\u6821\u53f2\u5c55\u89bd\u5ef3","b":"E1","lat":22.13094,"lon":113.5458},
{"a":"\u9ad4\u80b2\u9928","b":"SC","lat":22.13394,"lon":113.54261},
{"a":"\u4e2d\u592e\u5546\u696d\u5340","b":"CBD","lat":22.12432,"lon":113.54448},
{"a":"科研大樓","b":"N21","lat":22.1350166,"lon":113.5452397},
{"a":"能源環境大樓","b":"EER","lat":22.13561,"lon":113.54527},
{"a":"\u4e2d\u91ab\u85e5\u79d1\u7814\u5927\u6a13","b":"CMS","lat":22.13505,"lon":113.54324},
{"a":"\u5927\u5b78\u8cd3\u9928 ","b":"UGH","lat":22.13369,"lon":113.54554},
{"a":"\u5b78\u751f\u6d3b\u52d5\u4e2d\u5fc3","b":"SAC","lat":22.12692,"lon":113.54412},
{"a":"\u6559\u80b2\u5b78\u9662","b":"FED","lat":22.12584,"lon":113.54415},
{"a":"\u751f\u547d\u5065\u5eb7\u5b78\u9662","b":"FHS","lat":22.13087,"lon":113.54323},
{"a":"\u6cd5\u5b78\u9662","b":"FLL","lat":22.12638,"lon":113.5438},
{"a":"\u79d1\u6280\u5b78\u9662","b":"FST(E11)","lat":22.13239,"lon":113.54325},
{"a":"\u5546\u5b78\u9662","b":"FBA","lat":22.12815,"lon":113.54315},
{"a":"\u793e\u6703\u79d1\u5b78\u5b78\u9662","b":"FSS(E21B)","lat":22.12896,"lon":113.54292},
{"a":"\u6587\u85dd\u5b78\u9662","b":"E21A","lat":22.12955,"lon":113.543},
{"a":"\u8a2d\u8a08\u5b78\u9662","b":"FD","lat":22.12529,"lon":113.54361},
{"a":"\u66f8\u9662\u4e00 ","b":"RC1","lat":22.13223,"lon":113.54118},
{"a":"\u66f8\u9662\u4e8c ","b":"RC2","lat":22.13231,"lon":113.54185},
{"a":"\u66f8\u9662\u4e09 ","b":"RC3","lat":22.13117,"lon":113.54108},
{"a":"\u66f8\u9662\u56db ","b":"RC4","lat":22.13141,"lon":113.54186},
{"a":"\u66f8\u9662\u4e94","b":"RC5","lat":22.12938,"lon":113.54113},
{"a":"\u66f8\u9662\u516d","b":"RC6","lat":22.1294,"lon":113.54164},
{"a":"\u66f8\u9662\u4e03","b":"RC7","lat":22.12822,"lon":113.54138},
{"a":"\u66f8\u9662\u516b","b":"RC8","lat":22.12637,"lon":113.54136},
{"a":"\u66f8\u9662\u4e5d","b":"RC9","lat":22.12635,"lon":113.54216},
{"a":"\u66f8\u9662\u5341","b":"RC10","lat":22.12552,"lon":113.54162},
{"a":"\u66f8\u9662\u5341\u4e00","b":"RC11","lat":22.12542,"lon":113.5424},
{"a":"\u66f8\u9662\u5341\u4e8c","b":"RC12","lat":22.12436,"lon":113.5436},
{"a":"\u7814\u7a76\u751f\u5bbf\u820dA\u5340","b":"PHA","lat":22.12488,"lon":113.54597},
{"a":"\u7814\u7a76\u751f\u5bbf\u820dB\u5340","b":"PHB","lat":22.12444,"lon":113.54505},
{"a":"\u7814\u7a76\u751f\u5bbf\u820dC1\u5340","b":"PHC1(PHC2 PHC3)","lat":22.12372,"lon":113.54559},
{"a":"\u7814\u7a76\u751f\u5bbf\u820dD\u5340","b":"PHD","lat":22.12377,"lon":113.54481},
{"a":"A1\u8077\u54e1\u5bbf\u820d","b":"SQA1","lat":22.12301,"lon":113.54383},
{"a":"A2\u8077\u54e1\u5bbf\u820d","b":"SQA2","lat":22.12298,"lon":113.54421},
{"a":"C1\u8077\u54e1\u5bbf\u820d","b":"SQC1","lat":22.12298,"lon":113.5447},
{"a":"C2\u8077\u54e1\u5bbf\u820d","b":"SQC2","lat":22.12298,"lon":113.54504},
{"a":"C3\u8077\u54e1\u5bbf\u820d","b":"SQC3","lat":22.12299,"lon":113.54547},
{"a":"C4\u8077\u54e1\u5bbf\u820d","b":"SQC4","lat":22.12299,"lon":113.54584},
{"a":"D2\u8077\u54e1\u5bbf\u820d","b":"SQD2","lat":22.12196,"lon":113.54592},
{"a":"E1\u8077\u54e1\u5bbf\u820d","b":"SQE1","lat":22.12197,"lon":113.54557},
{"a":"S36","b":"S36","lat":22.12144,"lon":113.54595},
{"a":"S31","b":"S31","lat":22.12142,"lon":113.54555},
{"a":"S28","b":"S28","lat":22.12247,"lon":113.54592},
{"a":"S35","b":"S35","lat":22.12248,"lon":113.54385}];
data1=[{"chinese":"大學會堂","NSWE":"N2","lat":22.1342,"lon":113.54551},
  {"chinese":"中央教學樓","NSWE":"E3~E7","lat":22.12848,"lon":113.54541},
  {"chinese":"中銀百年紀念大樓","NSWE":"E3","lat":22.12904,"lon":113.54585},
  {"chinese":"劉少榮樓","NSWE":"E4","lat":22.12861,"lon":113.54607},
  {"chinese":"中央教學樓","NSWE":"E5","lat": 22.128153711429235,"lon": 113.545427982712},
  {"chinese":"中央教學樓","NSWE":"E6","lat":22.1286,"lon":113.54509},
  {"chinese":"中央教學樓","NSWE":"E7","lat":22.12895,"lon":113.54514},
  {"chinese":"中央行政樓","NSWE":"N6","lat":22.13382,"lon":113.54424},
  {"chinese":"圖書館","NSWE":"E2","lat":22.13003,"lon":113.54486},
  {"chinese":"校史展覽廳","NSWE":"E1","lat":22.13094,"lon":113.5458},
  {"chinese":"體育館","NSWE":"N8","lat":22.13394,"lon":113.54261},
  {"chinese":"中央商業區","NSWE":"S8","lat":22.12432,"lon":113.54448},
  {"chinese":"科研大樓","NSWE":"N21","lat":22.1350166,"lon":113.5452397},
  {"chinese":"應用物理及材料工程研究所","NSWE":"N23","lat":22.13561,"lon":113.54527},
  {"chinese":"中醫藥科研大樓","NSWE":"N22","lat":22.13505,"lon":113.54324},
  {"chinese":"聚賢樓 ","NSWE":"N1","lat":22.13369,"lon":113.54554},
  {"chinese":"學生活動中心","NSWE":"E31","lat":22.12692,"lon":113.54412},
  {"chinese":"教育學院","NSWE":"E33","lat":22.12584,"lon":113.54415},
  {"chinese":"健康科學學院","NSWE":"E12","lat":22.13087,"lon":113.54323},
  {"chinese":"法學院","NSWE":"E32","lat":22.12638,"lon":113.5438},
  {"chinese":"科技學院","NSWE":"E11","lat":22.13239,"lon":113.54325},
  {"chinese":"商學院","NSWE":"E22","lat":22.12815,"lon":113.54315},
  {"chinese":"社會科學學院","NSWE":"E21B","lat":22.12896,"lon":113.54292},
  {"chinese":"人文學院","NSWE":"E21A","lat":22.12955,"lon":113.543},
  {"chinese":"設計學院","NSWE":"E34","lat":22.12529,"lon":113.54361},
  {"chinese":"蔡繼有書院 ","NSWE":"W12","lat":22.13223,"lon":113.54118},
  {"chinese":"滿珍紀念 ","NSWE":"W11","lat":22.13231,"lon":113.54185},
  {"chinese":"霍英東珍禧書院 ","NSWE":"W14","lat":22.13117,"lon":113.54108},
  {"chinese":"何鴻燊東亞書院","NSWE":"W13","lat":22.13141,"lon":113.54186},
  {"chinese":"呂志和書院","NSWE":"W22","lat":22.12938,"lon":113.54113},
  {"chinese":"曹光彪書院","NSWE":"W21","lat":22.1294,"lon":113.54164},
  {"chinese":"鄭裕彤書院","NSWE":"W23","lat":22.12822,"lon":113.54138},
  {"chinese":"書院八","NSWE":"W32","lat":22.12637,"lon":113.54136},
  {"chinese":"書院九","NSWE":"W31","lat":22.12635,"lon":113.54216},
  {"chinese":"張崑崙書院","NSWE":"W34","lat":22.12552,"lon":113.54162},
  {"chinese":"馬萬祺羅柏心書院","NSWE":"W33","lat":22.12542,"lon":113.5424},
  {"chinese":"紹邦書院","NSWE":"S9","lat":22.12436,"lon":113.5436},
  {"chinese":"研究生宿舍","NSWE":"S1","lat":22.12488,"lon":113.54597},
  {"chinese":"研究生宿舍","NSWE":"S2","lat":22.12444,"lon":113.54505},
  {"chinese":"研究生宿舍","NSWE":"S3","lat":22.12372,"lon":113.54559},
  {"chinese":"研究生宿舍","NSWE":"S4","lat":22.12377,"lon":113.54481},
  {"chinese":"教職員宿舍","NSWE":"S26","lat":22.12301,"lon":113.54383},
  {"chinese":"教職員宿舍","NSWE":"S25","lat":22.12298,"lon":113.54421},
  {"chinese":"教職員宿舍","NSWE":"S24","lat":22.12298,"lon":113.5447},
  {"chinese":"教職員宿舍","NSWE":"S23","lat":22.12298,"lon":113.54504},
  {"chinese":"教職員宿舍","NSWE":"S22","lat":22.12299,"lon":113.54547},
  {"chinese":"教職員宿舍","NSWE":"S21","lat":22.12299,"lon":113.54584},
  {"chinese":"教職員宿舍","NSWE":"S29","lat":22.12196,"lon":113.54592},
  {"chinese":"教職員宿舍","NSWE":"S30","lat":22.12197,"lon":113.54557},
  {"chinese":"教職員宿舍","NSWE":"S36","lat":22.12144,"lon":113.54595},
  {"chinese":"教職員宿舍","NSWE":"S31","lat":22.12142,"lon":113.54555},
  {"chinese":"教職員宿舍","NSWE":"S28","lat":22.12247,"lon":113.54592},
  {"chinese":"教職員宿舍","NSWE":"S35","lat":22.12248,"lon":113.54385}]

dataN=[{"chinese":"大學會堂","NSWE":"N2","lat":22.1342,"lon":113.54551},
{"chinese":"中央行政樓","NSWE":"N6","lat":22.13382,"lon":113.54424},
{"chinese":"體育館","NSWE":"N8","lat":22.13394,"lon":113.54261},
{"chinese":"科研大樓","NSWE":"N21","lat":22.1350166,"lon":113.5452397},
{"chinese":"應用物理及材料工程研究所","NSWE":"N23","lat":22.13561,"lon":113.54527},
{"chinese":"中醫藥科研大樓","NSWE":"N22","lat":22.13505,"lon":113.54324},
{"chinese":"聚賢樓 ","NSWE":"N1","lat":22.13369,"lon":113.54554}]

dataS=[{"chinese":"紹邦書院","NSWE":"S9","lat":22.12436,"lon":113.5436},
  {"chinese":"研究生宿舍","NSWE":"S1","lat":22.12488,"lon":113.54597},
  {"chinese":"研究生宿舍","NSWE":"S2","lat":22.12444,"lon":113.54505},
  {"chinese":"研究生宿舍","NSWE":"S3","lat":22.12372,"lon":113.54559},
  {"chinese":"研究生宿舍","NSWE":"S4","lat":22.12377,"lon":113.54481},
  {"chinese":"中央商業區","NSWE":"S8","lat":22.12432,"lon":113.54448},
  {"chinese":"教職員宿舍","NSWE":"S26","lat":22.12301,"lon":113.54383},
  {"chinese":"教職員宿舍","NSWE":"S25","lat":22.12298,"lon":113.54421},
  {"chinese":"教職員宿舍","NSWE":"S24","lat":22.12298,"lon":113.5447},
  {"chinese":"教職員宿舍","NSWE":"S23","lat":22.12298,"lon":113.54504},
  {"chinese":"教職員宿舍","NSWE":"S22","lat":22.12299,"lon":113.54547},
  {"chinese":"教職員宿舍","NSWE":"S21","lat":22.12299,"lon":113.54584},
  {"chinese":"教職員宿舍","NSWE":"S29","lat":22.12196,"lon":113.54592},
  {"chinese":"教職員宿舍","NSWE":"S30","lat":22.12197,"lon":113.54557},
  {"chinese":"教職員宿舍","NSWE":"S36","lat":22.12144,"lon":113.54595},
  {"chinese":"教職員宿舍","NSWE":"S31","lat":22.12142,"lon":113.54555},
  {"chinese":"教職員宿舍","NSWE":"S28","lat":22.12247,"lon":113.54592},
  {"chinese":"教職員宿舍","NSWE":"S35","lat":22.12248,"lon":113.54385}]

dataW=[
  {"chinese":"蔡繼有書院 ","NSWE":"W12","lat":22.13223,"lon":113.54118},
  {"chinese":"滿珍紀念 ","NSWE":"W11","lat":22.13231,"lon":113.54185},
  {"chinese":"霍英東珍禧書院 ","NSWE":"W14","lat":22.13117,"lon":113.54108},
  {"chinese":"何鴻燊東亞書院","NSWE":"W13","lat":22.13141,"lon":113.54186},
  {"chinese":"呂志和書院","NSWE":"W22","lat":22.12938,"lon":113.54113},
  {"chinese":"曹光彪書院","NSWE":"W21","lat":22.1294,"lon":113.54164},
  {"chinese":"鄭裕彤書院","NSWE":"W23","lat":22.12822,"lon":113.54138},
  {"chinese":"書院八","NSWE":"W32","lat":22.12637,"lon":113.54136},
  {"chinese":"書院九","NSWE":"W31","lat":22.12635,"lon":113.54216},
  {"chinese":"張崑崙書院","NSWE":"W34","lat":22.12552,"lon":113.54162},
  {"chinese":"馬萬祺羅柏心書院","NSWE":"W33","lat":22.12542,"lon":113.5424}]

dataE=[
  {"chinese":"中銀百年紀念大樓","NSWE":"E3","lat":22.12904,"lon":113.54585},
  {"chinese":"劉少榮樓","NSWE":"E4","lat":22.12861,"lon":113.54607},
  {"chinese":"中央教學樓","NSWE":"E5","lat": 22.128153711429235,"lon": 113.545427982712},
  {"chinese":"中央教學樓","NSWE":"E6","lat":22.1286,"lon":113.54509},
  {"chinese":"中央教學樓","NSWE":"E7","lat":22.12895,"lon":113.54514},
  {"chinese":"圖書館","NSWE":"E2","lat":22.13003,"lon":113.54486},
  {"chinese":"校史展覽廳","NSWE":"E1","lat":22.13094,"lon":113.5458},
  {"chinese":"學生活動中心","NSWE":"E31","lat":22.12692,"lon":113.54412},
  {"chinese":"教育學院","NSWE":"E33","lat":22.12584,"lon":113.54415},
  {"chinese":"健康科學學院","NSWE":"E12","lat":22.13087,"lon":113.54323},
  {"chinese":"法學院","NSWE":"E32","lat":22.12638,"lon":113.5438},
  {"chinese":"科技學院","NSWE":"E11","lat":22.13239,"lon":113.54325},
  {"chinese":"商學院","NSWE":"E22","lat":22.12815,"lon":113.54315},
  {"chinese":"社會科學學院","NSWE":"E21B","lat":22.12896,"lon":113.54292},
  {"chinese":"人文學院","NSWE":"E21A","lat":22.12955,"lon":113.543},
  {"chinese":"設計學院","NSWE":"E34","lat":22.12529,"lon":113.54361}]

const scene = new L7.Scene({
  id: 'map',
  logoVisible: false,
  map: new L7.Mapbox({
    // style: 'mapbox://styles/mapbox/light-v10', // 样式URL
    style: 'mapbox://styles/mapbox/light-v10', // 样式URL
    rotateEnable: false,
    center: [113.54385310305383,22.12864222905418],
    pitch: 0,
    zoom: 16,
    minZoom: 1.3,
    token: 'pk.eyJ1IjoiYm9uZHkxMjIxIiwiYSI6ImNrc3N3eGVyejA2cjcycWxzeHBqc3hoM2kifQ.HKHZjt-CfDYM3msWMw8WgA',
  }),
});

const data0 = []
// const dataaa=[{ "lat": 22.13394, "lon": 113.54261,"size":1000,'style':[1,10,1.0]}]


const datatest=[{"lat": 22.13394, "lon": 113.54261,"size":1000},
{"lat": 22.13394, "lon": 113.54261,"size":1000},
]
const heatlayer = new L7.HeatmapLayer({})
  .source(data0, {
    parser: {
      type: 'json',
      x: 'lon',
      y: 'lat',
    },
  })
  .size('size', (size) => {
    if(size==1)
      return 0.2;
    // else if(size<100)
    //   return 2;
    // else if(size>100&size<200)
    //   return 4;
    return size;
  })
  .shape('heatmap')
  .style({
    intensity: 5,//越大贡献度越明显
    radius: 14,
    opacity: 0.5,
    rampColors: {
      colors: [
        '#FF4818',
        '#F7B74A',
        '#FFF598',
        '#206C7C',
        '#2EA9A1',
        '#91EABC'
        // '#FF4818',
        // '#F7B74A',
        // '#FFF598',
        // '#F27DEB',
        // '#8C1EB2',
        // '#421EB2'
      ].reverse(),
      positions: [0, 0.2, 0.4, 0.6, 0.8, 1.0]
    }
  });
// 


// const heatlayer1 = new L7.HeatmapLayer({})
// .source(data1, {
//   parser: {
//     type: 'json',
//     x: 'lon',
//     y: 'lat',
//   },
// })
// .size(3)
// .shape('heatmap')
// .style({
//   intensity: 5,//越大贡献度越明显
//   radius: 14,
//   opacity: 0.5,
//   rampColors: {
//     colors: [
//       '#FF4818',
//       '#F7B74A',
//       '#FFF598',
//       '#206C7C',
//       '#2EA9A1',
//       '#91EABC'
//       // '#FF4818',
//       // '#F7B74A',
//       // '#FFF598',
//       // '#F27DEB',
//       // '#8C1EB2',
//       // '#421EB2'
//     ].reverse(),
//     positions: [0, 0.2, 0.4, 0.6, 0.8, 1.0]
//   }
// });
// // 

const pointLayer = new L7.PointLayer({})
  .source(data0, {
    parser: {
      type: 'json',
      x: 'lon',
      y: 'lat'
    }
  })
  .shape('circle')
  .size('size', (size) => {
    // return Math.pow(size,8);
    return Math.sqrt(size);
  })
  // .color("size",(value)=>{
  //   if(value>100)
  //     return '#FF4818';

  //   return '#0410BA';
  // })
  .color('#FF4818')
  .style({
    opacity: 1,
    strokeWidth: 0
  });


const NLayer = new L7.PointLayer()
  .source(dataN, {
    parser: {
      type: 'json',
      x: 'lon',
      y: 'lat',
    }
  })
  .shape('NSWE', 'text')
  .color('rgb(47,79,79)')
  .size(15);

const SLayer = new L7.PointLayer()
.source(dataS, {
  parser: {
    type: 'json',
    x: 'lon',
    y: 'lat',
  }
})
.shape('NSWE', 'text')
.color('rgb(0,100,0)')
.size(15);

const WLayer = new L7.PointLayer()
.source(dataW, {
  parser: {
    type: 'json',
    x: 'lon',
    y: 'lat',
  }
})
.shape('NSWE', 'text')
.color('rgb(0,0,255)')
.size(15);

const ELayer = new L7.PointLayer()
  .source(dataE, {
    parser: {
      type: 'json',
      x: 'lon',
      y: 'lat',
    }
  })
  .shape('NSWE', 'text')
  .color('rgb(178,34,34)')
  .size(15);

scene.on('loaded', () => {

  scene.setRotation(270);
  scene.addLayer(heatlayer);
  scene.addLayer(NLayer);
  scene.addLayer(SLayer);
  scene.addLayer(WLayer);
  scene.addLayer(ELayer);
});

scene.on('contextmenu', (ev) => {
  const wrapped = ev.lngLat.wrap();
  console.log("lng: "+wrapped.lng+", lat: "+wrapped.lat)
});
